# Модель данных

## Пользователи (Users)
*Используется в UserRepository*

| Поле        | Тип       | Описание                                 |
|-------------|-----------|------------------------------------------|
| id          | UUID      | Уникальный идентификатор пользователя    |
| type        | Enum      | Тип пользователя (customer, specialist)  |
| email       | String    | Email пользователя, используется как логин |
| passwordHash| String    | Хеш пароля                               |
| firstName   | String    | Имя пользователя                         |
| lastName    | String    | Фамилия пользователя                     |
| phone       | String    | Телефон пользователя                     |
| createdAt   | Timestamp | Дата создания учетной записи             |
| updatedAt   | Timestamp | Дата последнего обновления учетной записи |

## Профили специалистов (SpecialistProfiles)
*Используется в UserRepository*

| Поле        | Тип       | Описание                                 |
|-------------|-----------|------------------------------------------|
| id          | UUID      | Уникальный идентификатор профиля         |
| userId      | UUID      | Внешний ключ на таблицу Users            |
| bio         | Text      | Описание специалиста                     |
| experience  | Integer   | Опыт работы (в годах)                    |
| rating      | Decimal   | Средний рейтинг                          |
| createdAt   | Timestamp | Дата создания профиля                    |
| updatedAt   | Timestamp | Дата последнего обновления профиля       |

## Категории услуг (Categories)
*Используется в ServiceRepository*

| Поле        | Тип       | Описание                                 |
|-------------|-----------|------------------------------------------|
| id          | UUID      | Уникальный идентификатор категории       |
| name        | String    | Название категории                       |
| description | Text      | Описание категории                       |
| parentId    | UUID      | Ссылка на родительскую категорию (если есть) |
| createdAt   | Timestamp | Дата создания категории                  |
| updatedAt   | Timestamp | Дата последнего обновления категории     |

## Услуги (Services)
*Используется в ServiceRepository*

| Поле        | Тип       | Описание                                 |
|-------------|-----------|------------------------------------------|
| id          | UUID      | Уникальный идентификатор услуги          |
| specialistId| UUID      | Внешний ключ на таблицу Users            |
| categoryId  | UUID      | Внешний ключ на таблицу Categories       |
| name        | String    | Наименование услуги                      |
| description | Text      | Описание услуги                          |
| price       | Decimal   | Стоимость услуги                         |
| duration    | Integer   | Продолжительность услуги (в минутах)     |
| createdAt   | Timestamp | Дата создания услуги                     |
| updatedAt   | Timestamp | Дата последнего обновления услуги        |
| searchVector| tsvector  | Векторное представление для полнотекстового поиска |

## Заказы (Orders)
*Используется в OrderRepository*

| Поле        | Тип       | Описание                                 |
|-------------|-----------|------------------------------------------|
| id          | UUID      | Уникальный идентификатор заказа          |
| customerId  | UUID      | Внешний ключ на таблицу Users (клиент)   |
| status      | Enum      | Статус заказа (new, confirmed, completed, canceled) |
| totalAmount | Decimal   | Общая стоимость заказа                   |
| createdAt   | Timestamp | Дата создания заказа                     |
| updatedAt   | Timestamp | Дата последнего обновления заказа        |

## Элементы заказа (OrderItems)
*Используется в OrderRepository*

| Поле        | Тип       | Описание                                 |
|-------------|-----------|------------------------------------------|
| id          | UUID      | Уникальный идентификатор элемента заказа |
| orderId     | UUID      | Внешний ключ на таблицу Orders           |
| serviceId   | UUID      | Внешний ключ на таблицу Services         |
| quantity    | Integer   | Количество услуг                         |
| price       | Decimal   | Цена услуги на момент заказа             |
| scheduledAt | Timestamp | Запланированное время услуги             |
| createdAt   | Timestamp | Дата создания элемента заказа            |
| updatedAt   | Timestamp | Дата последнего обновления элемента заказа |

## Полнотекстовый поиск в PostgreSQL

Для реализации полнотекстового поиска используются возможности PostgreSQL:

1. **Индексы** - для таблиц Users и Services созданы GIN-индексы по полям, участвующим в поиске
2. **Триггеры** - автоматически обновляют поля searchVector при изменении данных
3. **Функции** - для формирования и выполнения поисковых запросов

Поиск осуществляется с помощью типов данных tsvector (для индексируемого содержимого) и tsquery (для поисковых запросов), что обеспечивает эффективный полнотекстовый поиск без необходимости использования отдельного поискового движка. 